<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../iron-selector/iron-selectable.html">
<link rel="import" href="../paper-radio-button/paper-radio-button.html">
<link rel="import" href="../iron-a11y-keys-behavior/iron-a11y-keys-behavior.html">

<!--
`paper-radio-group` allows user to select only one radio button from a set.
Checking one radio button that belongs to a radio group unchecks any
previously checked radio button within the same group. Use
`selected` to get or set the selected radio button.

Example:

    <paper-radio-group selected="small">
      <paper-radio-button name="small" label="Small"></paper-radio-button>
      <paper-radio-button name="medium" label="Medium"></paper-radio-button>
      <paper-radio-button name="large" label="Large"></paper-radio-button>
    </paper-radio-group>

See <a href="paper-radio-button.html">paper-radio-button</a> for more
information about `paper-radio-button`.

@group Paper Elements
@element paper-radio-group
@hero hero.svg
@demo demo/index.html
-->

<dom-module name="paper-radio-group">
  <style>
    :host {
      display: inline-block;
    }

    :host ::content > * {
      padding: 12px;
    }
  </style>

  <template>
      <content id="items" select="*"></content>
  </template>

</dom-module>

<script>
  Polymer({
    is: 'paper-radio-group',

    behaviors: [
      Polymer.IronA11yKeysBehavior,
      Polymer.IronSelectableBehavior
    ],

    hostAttributes: {
      role: 'radiogroup',
      tabindex: 0
    },

    properties: {
      /**
       * If you want to use the attribute value of an element for `selected` instead of the index,
       * set this to the name of the attribute.
       *
       * @attribute attrForSelected
       * @type {string}
       */
      attrForSelected: {
        type: String,
        value: "name",
        readOnly: true
      }
    },

    keyBindings: {
      'left up': 'selectPrevious',
      'right down': 'selectNext',
    },

    ready: function() {
      // TODO: This only needs to be async while a domReady event is unavailable.
      if (this.selected) {
        this.async(function() {
          this._valueToItem(this.selected).checked = true;
        });
      }
    },

    /**
     * Selects the given value.
     *
     * @method select
     * @param {string} value the value to select.
     */
    select: function(value) {
      var oldItem = this._valueToItem(this.selected);

      // Do not allow unchecking the selected item.
      if (value == this.selected && oldItem.checked == true) {
        return;
      }

      if (oldItem)
        oldItem.checked = false;
      this.selected = value;
      this._valueToItem(this.selected).checked = true;
      this.fire('paper-radio-group-changed');
    },

    /**
     * Selects the previous item. If the previous item has a `disabled` attribute
     * then it is skipped, and its previous item is selected
     *
     * @method selectPrevious
     */
    selectPrevious: function() {
      var length = this.items.length;
      var newIndex = Number(this._valueToIndex(this.selected));

      do {
        newIndex = (newIndex - 1 + length) % length;
      } while (this.items[newIndex].disabled)

      this.select(this._indexToValue(newIndex));
    },

    /**
     * Selects the next item.
     *
     * @method selectNext
     */
    selectNext: function() {
      var length = this.items.length;
      var newIndex = Number(this._valueToIndex(this.selected));

      do {
        newIndex = (newIndex + 1 + length) % length;
      } while (this.items[newIndex].disabled)

      this.select(this._indexToValue(newIndex));
    },
  });
</script>
